@using System.Web.UI.HtmlControls
@model Ampbi.DataAccess.ViewModel.DashBoard

@{
    ViewBag.Title = "IndividualEmpPerf";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}
@using (Html.BeginForm("IndividualEmpPerf", "DashBoard"))
{
    <div class="page-container row-fluid">
        <!-- START CONTENT -->
        <section id="main-content" class="sidebar_shift sidebar_shift-reg">
            <section class="wrapper wrap-box">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 pan0 top-box-search">
                    <div class="page-title">
                        <div class="tab-content pull-left col-md-8 col-sm-12 col-xs-12 mart10">

                            <!--Intraday-->

                            <div role="tabpanel" class="tab-pane" id="Intraday">
                                <div class="pull-left"><strong class="fonts24" id="IntradayID"></strong></div>
                                <div class="clearfix">
                                    <input id="ex4" data-slider-id='ex1Slider' type="text" data-slider-min="-13" data-slider-max="0" data-slider-value="0" data-slider-step="1" />
                                </div>
                            </div>

                            <!--Daily-->

                            <div role="tabpanel" class="tab-pane active" id="Daily">
                                <div class="pull-left"><strong class="fonts24" id="DailyID"></strong></div>
                                <div class="clearfix">
                                    <input id="ex3" data-slider-id='ex1Slider' type="text" data-slider-min="-13" data-slider-max="0" data-slider-value="-1" data-slider-step="1">
                                </div>
                            </div>

                            <!--Weekly-->

                            <div role="tabpanel" class="tab-pane" id="Weekly">
                                <div class="pull-left"><strong class="fonts24" id="WeekID"></strong></div>
                                <div class="clearfix">
                                    <input id="ex2" data-slider-id='ex1Slider' type="text" data-slider-min="-12" data-slider-max="0" data-slider-value="0" data-slider-step="1" />
                                </div>
                            </div>

                            <!--Month-->

                            <div role="tabpanel" class="tab-pane" id="Month">
                                <div class="pull-left"><strong class="fonts24" id="MonthID"></strong></div>
                                <div class="clearfix">
                                    <input id="ex1" data-slider-id='ex1Slider' data-slider-min="-13" data-slider-max="0" data-slider-value="0" data-slider-step="1" />
                                </div>
                            </div>


                        </div>
                        <nav class="navbar-default" role="navigation">
                            <div class="navbar-header">
                                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbarCollapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
                            </div>
                            <div class="pull-right">
                                <ul class="nav navbar-nav navbar-right btn-group nav-tabs" role="tablist">
                                    <li role="presentation"><a style="margin: 0px;" href="#Intraday" aria-controls="Intraday" onclick="getIntraday();" role="tab" data-toggle="tab" id="btnIntraday">Intraday</a></li>
                                    <li role="presentation" class="active"><a style="margin: 0px;" href="#Daily" aria-controls="Daily" role="tab" data-toggle="tab" id="btnDaily">Daily</a></li>
                                    <li role="presentation"><a style="margin: 0px;" href="#Weekly" aria-controls="Weekly" onclick="GetWeekINfo();" role="tab" data-toggle="tab" id="btnWeekly">Weekly</a></li>
                                    <li role="presentation"><a style="margin: 0px;" href="#Month" aria-controls="Month" role="tab" onclick="GetMonthINfo();" data-toggle="tab" id="btnMonth">Month</a></li>
                                </ul>
                            </div>
                        </nav>

                    </div>
                </div>
                <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 mart20">
                    @if (Model.empIndOthrDetailsList.Count != 0 || Model.empIndPerfCard.Count != 0)
                    {
                        <div class="col-md-3">
                            <div class="clearfix"></div>
                            <div class="pull-left pad0 col-md-3">
                                <img src="/Content/assets/images/pic.png" alt="">
                            </div>
                            <div class="pull-right col-md-9 padr mart10">
                                <h3>@Model.IndividualPerfCardObjects.FirstName @Model.IndividualPerfCardObjects.LastName</h3>
                                <p>@Model.IndividualPerfCardObjects.Title</p>
                            </div>
                            <div class="clearfix"></div>
                            <ul class="nav nav-tabs text-align-box know-align-box-emp" style="background: #ccccca; border-bottom: none; font-size: 12px; line-height: 30px !important; height: 30px;" role="tablist">
                                <li id="teamComp" role="presentation" class="col-md-6 pad0"><a class="pad0" style="line-height: 30px;" href="#IntSet" aria-controls="IntSet" role="tab" data-toggle="tab">Team Comparison</a></li>
                                <li id="orgComp" role="presentation" class="col-md-6 pad0"><a class="pad0" style="line-height: 30px;" href="#IntShow" aria-controls="IntShow" role="tab" data-toggle="tab">Organization Comparison</a></li>
                            </ul>
                            <div class="clearfix mart10"></div>
                            <h5 class="col-md-12">@Model.IndividualPerfCardObjectsOtherDetails.companyname</h5>
                            <ul class="color-box col-md-8">
                                <li class="red-tdt">@Model.IndividualPerfCardObjectsOtherDetails.IntApt</li>
                                <li class="green-tdt">@Model.IndividualPerfCardObjectsOtherDetails.PhoneApt</li>
                            </ul>
                        </div>

                        <div id="EmpPerfCards">
                            @Html.Partial("_PartialEmpPerfCards", Model)
                        </div> 
                        
                    }
                </div>


                <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 mart20" id="tblCoaching">
                    <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active" id="CoachingHist"><a href="#CoachingHist1" aria-controls="CoachingHist1" role="tab" data-toggle="tab">Coaching Hstory</a></li>
                        <li role="presentation" id="TrningHist"><a href="#TrningHist1" aria-controls="TrningHist1" role="tab" data-toggle="tab">Training History</a></li>
                        <li role="presentation"><a href="#Task" aria-controls="Task" role="tab" data-toggle="tab">Task</a></li>
                    </ul>

                    <div class="tab-content">

                        <div role="tabpanel" class="tab-pane" id="CoachingHist1">
                            <div class="table-responsive">
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr class="blue-t">
                                            <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-ok" aria-hidden="true"></i></th>
                                            <td align="center" valign="middle">Date </td>
                                            <td align="center" valign="middle">Matric(s)</td>
                                            <td align="center" valign="middle">Reason</td>
                                            <td align="center" valign="middle">Goal</td>
                                            <td align="center" valign="middle">Commitment</td>
                                            <td align="center" valign="middle">Actual</td>
                                            <td align="right"><i class="glyphicon glyphicon-volume-up" aria-hidden="true"></i></td>
                                        </tr>
                                        @if (Model.empIndGridList != null)
                                        {
                                            if (Model.empIndGridList.Count != 0)
                                            {
                                                foreach (var item in Model.empIndGridList)
                                                {
                                            <tr class="red-tdt">
                                                <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></th>
                                                <td align="center" valign="middle">@Html.DisplayFor(modelItem => item.coachingassigneddate)</td>
                                                <td align="center" valign="middle">@Html.DisplayFor(modelItem => item.KPIMetricName)</td>
                                                <td align="center" valign="middle">@Html.DisplayFor(modelItem => item.Reason)</td>
                                                <td align="center" valign="middle">@Html.DisplayFor(modelItem => item.Goal)</td>
                                                <td align="center" valign="middle">@Html.DisplayFor(modelItem => item.commitment)</td>
                                                <td align="center" valign="middle">@Html.DisplayFor(modelItem => item.Actual)</td>
                                                <td align="right"><i class="glyphicon glyphicon-play-circle" aria-hidden="true"></i></td>
                                            </tr>
                                                }
                                            }
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane active" id="TrningHist1">
                            <div class="table-responsive">
                                <table class="table table-bordered">
                                    <tbody>
                                        <tr class="blue-t">
                                            <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-ok" aria-hidden="true"></i></th>
                                            <td align="center" valign="middle">Targeted Completion Date </td>
                                            <td align="center" valign="middle">Date Assigned</td>
                                            <td align="center" valign="middle">Actual Completion Date</td>
                                            <td align="center" valign="middle">Article Name</td>
                                            <td align="center" valign="middle">Associated Metric</td>
                                            <td align="right"><i class="glyphicon glyphicon-volume-up" aria-hidden="true"></i></td>
                                        </tr>
                                        @if (Model.empIndGridTrainingList != null)
                                        {
                                            if (Model.empIndGridTrainingList.Count != 0)
                                            {
                                                foreach (var item in Model.empIndGridTrainingList)
                                                {
                                            <tr class="red-tdt">
                                                @*<th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></th>*@
                                                <th align="center" valign="middle" scope="row">
                                                <td>@Html.DisplayFor(modelItem => item.TargetedCompletionDate)</td>
                                                <td>@Html.DisplayFor(modelItem => item.CoachingAssignedDate)</td>
                                                <td>@Html.DisplayFor(modelItem => item.ActualCompletionDate)</td>
                                                <td>@Html.DisplayFor(modelItem => item.articlename)</td>
                                                <td>@Html.DisplayFor(modelItem => item.AssociatedMetric)</td>
                                                <td><i class="glyphicon glyphicon-play-circle" aria-hidden="true"></i></td>
                                            </tr>
                                                }
                                            }
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="Task">
                            3
        @*<div class="table-responsive">
            <table width="100%" class="table table-bordered">
                <tbody>
                    <tr class="blue-t">
                        <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-ok" aria-hidden="true"></i></th>
                        <td align="center" valign="middle">Date </td>
                        <td align="center" valign="middle">Matric(s)</td>
                        <td align="center" valign="middle">Reason</td>
                        <td align="center" valign="middle">Goal</td>
                        <td align="center" valign="middle">Commitment</td>
                        <td align="center" valign="middle">Actual</td>
                        <td align="right"><i class="glyphicon glyphicon-volume-up" aria-hidden="true"></i></td>
                    </tr>
                </tbody>
            </table>
        </div>*@
                        </div>
                    </div>





                    @* @Html.Partial("_PartialEmpPerfGrid", Model)*@


                </div>
                @*  
                <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 mart20" style="display: none;" id="tblTraining">
                    @Html.Partial("_PartialEmpPerfGrid", Model)
                </div>

                <div id="EmpPerfGridCoaching">
                    @Html.Partial("_PartialEmpPerfGrid", Model)
                </div>*@

                @if (Model.empIndOthrDetailsList.Count == 0)
                {
                    <table id="tblNodata" style="width: 100%; position: absolute; margin-top: 19%;">
                        <tbody>
                            <tr>

                                <td colspan="6" style="vertical-align: middle; text-align: center; font-size: medium;">
                                    <br />
                                    <span style="background-color: #396b9e; color: white; border-radius: 5px; padding: 6px; white-space: nowrap; font-size: 16px;">No Data</span>


                                </td>
                            </tr>
                        </tbody>
                    </table>

                }

            </section>
        </section>
        <!-- END CONTENT -->
        <input name="hdnSrvtDtime" id="hdnSrvtDtime" type="hidden">
        <input name="Type" id="typeID" type="hidden" />
    </div>
    <!-- END CONTAINER --> 
    
    
    <script>

        $(document).ready(function () {
            var d = new Date();

            var month = d.getMonth() + 1;
            var day = d.getDate();
            var year = d.getFullYear();
            var hr = d.getHours();
            var mi = d.getMinutes();
            var sec = d.getSeconds();
            $('#hdnSrvtDtime').val(year + ',' + month + ',' + day + ',' + hr + ',' + mi + ',' + sec);
            getDaily();

            $("#btnMonth").on("click", function () {
                SonicDashboard_getDate('ex1', 'MONTHLY');

            });
            $("#btnWeekly").on("click", function () {
                SonicDashboard_getDate('ex2', 'WEEKLY');

            });
            $("#btnDaily").on("click", function () {
                SonicDashboard_getDate('ex3', 'DAILY');

            });
            $("#btnIntraday").on("click", function () {
                SonicDashboard_getDate('ex4', 'INTRADAY');


            });
            ///Change event of Slider
            $('#ex1').on('change', function () {
                SonicDashboard_getDate('ex1', 'MONTHLY');

            });
            $('#ex2').on('change', function () {
                SonicDashboard_getDate('ex2', 'WEEKLY');

            });
            $('#ex3').on('change', function () {
                SonicDashboard_getDate('ex3', 'DAILY');

                $('#ex4').on('change', function () {
                    SonicDashboard_getDate('ex4', 'INTRADAY');

                });

            });
        });
        setInterval(function () { SonicDashboard_getDate(); }, 250);
        function SonicDashboard_getDate(slider, type) {
            var servrDat = $("#hdnSrvtDtime").val();
            var sliderVal = $("#" + slider).val();;
            if (servrDat != '') {
                var mySplitResult = servrDat.split(",");
                var a = new Date(mySplitResult[0], (mySplitResult[1] - 1).toString(), mySplitResult[2], mySplitResult[3], mySplitResult[4], mySplitResult[5]);
                //var selected = $("input[type='radio'][name='radio-choice-h-230']:checked");
                var mydate;
                switch (type) {
                    case 'MONTHLY':
                        $('#typeID').val('M');
                        mydate = a.addMonths(parseInt(sliderVal));
                        $("#MonthID").html(mydate.toString('MMM yyyy'));
                        //$("#hdnDateSelected").val(mydate.toString('MM/dd/yyyy'));
                        break;
                    case 'DAILY':
                        $('#typeID').val('D');
                        var dt = a.addDays(sliderVal);
                        var dy = dt.toString('d');
                        var mt = dt.toString('MMM');
                        var yr = dt.toString('yyyy');
                        //$("#hdnDateSelected").val(dt.toString('MM/dd/yyyy'));
                        $('#DailyID').html((mt + ' ' + dy + ' ' + yr).toString('MMM/d/yyyy'));
                        break;
                    case 'WEEKLY':
                        $('#typeID').val('W');
                        var dt;
                        if (sliderVal == 0) {
                            dt = a;
                        }
                        else {
                            dt = a.sunday();
                            dt.addWeeks(sliderVal);
                        }
                        var dy = dt.toString('d');
                        var mt = dt.toString('MMM');
                        var yr = dt.toString('yyyy');
                        //$("#hdnDateSelected").val(dt.toString('MM/dd/yyyy'));
                        $("#WeekID").html(mt + ' ' + dy + ' ' + yr);
                        break;

                    case 'INTRADAY':
                        $('#typeID').val('I');
                        var dt = a.addHours(sliderVal);
                        var dy = dt.toString('d');
                        var mt = dt.toString('MMM');
                        var yr = dt.toString('yyyy');
                        var hr = dt.toString('h');
                        var tt = dt.toString('tt');
                        var hour = dt.toString('hh');
                        if (tt == "PM" && hour < 12) {
                            hour = parseInt(hour) + 12;
                        }
                        $("#hdnDateSelected").val(dt.toString('MM/dd/yyyy') + " " + hour + ":" + dt.toString('mm') + ":" + dt.toString('ss'));
                        if (hr == 0) { hr = 12; }
                        $('#IntradayID').html(hr + ' ' + tt + ' ' + mt + ' ' + dy + ' ' + yr);
                        break;
                }
            }
        }
        function GetMonthINfo() {
            SonicDashboard_getDate('ex1', 'MONTHLY');

        };

        function GetWeekINfo() {
            SonicDashboard_getDate('ex2', 'WEEKLY');
        };

        function getDaily() {
            SonicDashboard_getDate('ex3', 'DAILY');


        };
        function getIntraday() {
            SonicDashboard_getDate('ex4', 'INTRADAY');
        };

        $("#CoachingHist").on("click", function () {
            $.ajax({
                //url: hostAddress + "/ApprovalTask/CreateMetadata_Test",
                url: '@Url.Action("bindCoachingGridPerformance", "DashBoard")',
                success: function (data) {
                    $('#EmpPerfGridCoaching').html(data);

                },
                error: function (result) {
                    alert('Cannot update selection values now!!');
                }
            });
        });

        $("#TrningHist").on("click", function () {
            $.ajax({
                //url: hostAddress + "/ApprovalTask/CreateMetadata_Test",
                url: '@Url.Action("bindTrainingGridPerformance", "DashBoard")',
                success: function (data) {
                    $('#EmpPerfGridCoaching').html(data);
                },
                error: function (result) {
                    alert('Cannot update selection values now!!');
                }
            });
        });


        $("#teamComp").on("click", function () {
            $.ajax({
                //url: hostAddress + "/ApprovalTask/CreateMetadata_Test",
                url: '@Url.Action("bindTrainingGridPerformance", "DashBoard")',
                success: function (data) {
                    $('#PerfCardDefault').hide();
                    $('#Organization').hide();
                    $('#EmpPerfCards').html(data);
                },
                error: function (result) {
                    alert('Cannot update selection values now!!');
                }
            });
        });

    </script>

}