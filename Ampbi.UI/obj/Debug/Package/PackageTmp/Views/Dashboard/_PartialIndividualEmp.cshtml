@model Ampbi.DataAccess.ViewModel.DashBoard
@using System.Web.UI.WebControls

<div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 mart20">
    @if (Model.empIndPerfCard.Count != 0)
    {
        <div class="col-md-3 padr" style="border: solid 1px #ccc; padding: 10px;">
            <div class="clearfix"></div>
            <div class="pull-left pad0 col-md-3">
                <img src="/Content/assets/images/pic.png" alt="">
            </div>
            <div class="pull-right col-md-9 padr mart10">
               <a href="#" onclick="showKPIMetric();" > <h3>@Model.IndividualPerfCardObjects.FirstName @Model.IndividualPerfCardObjects.LastName</h3></a>
                <p>@Model.IndividualPerfCardObjects.Title</p>
                <p>@Session["EmpprgName"].ToString()</p>
            </div>
            <div class="clearfix"></div>
            <ul class="nav nav-tabs text-align-box text-color" style="background: #ccccca; border-bottom: none; font-size: 12px; line-height: 30px !important; height: 30px;" role="tablist">
                <li id="teamComp" role="presentation" class="col-md-6 pad0 active"><a class="pad0" onclick="TeamComparisonScreen();"  style="line-height: 30px;" href="#IntSet" aria-controls="IntSet" role="tab" data-toggle="tab">Team Comparison</a></li>
                <li id="orgComp" role="presentation" class="col-md-6 pad0"><a class="pad0" onclick="OrgComparisonScreen();" style="line-height: 30px;" href="#IntShow" aria-controls="IntShow" role="tab" data-toggle="tab">Organization Comparison</a></li>
            </ul>
            <div class="clearfix mart10"></div>
            <div class="col-md-3"></div>
            <h5 class="col-md-9">@Model.IndividualPerfCardObjectsOtherDetails.companyname</h5>
            @* <ul class="color-box col-md-8">
                                <li class="red-tdt">@Model.IndividualPerfCardObjectsOtherDetails.IntApt</li>
                                <li class="green-tdt">@Model.IndividualPerfCardObjectsOtherDetails.PhoneApt</li>
                            </ul>*@
        </div>

        <div id="EmpPerfCards">
            @Html.Partial("_PartialEmpPerfCards", Model)
        </div> 




	<div id="TeamComparison" class="TeamComp">
        </div>
        <div id="OrgComparison" class="OrgComp">
        </div>



                        
    }
</div>

@if (Model.empIndOthrDetailsList.Count == 0 || Model.empIndPerfCard.Count == 0)
{
    <table id="tblNodata" style="width: 100%; position: absolute; margin-top: 14%;">
        <tbody>
            <tr>

                <td colspan="6" style="vertical-align: middle; text-align: center; font-size: medium;">
                    <br />
                    <span style="background-color: #396b9e; color: white; border-radius: 5px; padding: 6px; white-space: nowrap; font-size: 16px;">No Data</span>


                </td>
            </tr>
        </tbody>
    </table>

}
@if (Model.empIndPerfCard.Count != 0)
{

    <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 mart20" id="tblCoaching">

        @*     -----------------------------------------Code for Grid-----------------------------------------*@


        <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 mart20">
            <ul class="nav nav-tabs text-color" role="tablist">
                <li role="presentation" class="active"><a href="#Coaching" aria-controls="Coaching" role="tab" data-toggle="tab">Coaching History</a></li>
                <li role="presentation"><a href="#Training" aria-controls="Training" role="tab" data-toggle="tab">Training History</a></li>
                <li role="presentation"><a href="#Task" aria-controls="Task" role="tab" data-toggle="tab">Task</a></li>

            </ul>

            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="Coaching">
                    <div class="table-responsive">
                        <table width="100%" class="table table-bordered table-striped">
                            <tbody>
                                <tr>
                                    <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-ok" aria-hidden="true"></i></th>
                                    <td align="center" valign="middle">Date </td>
                                    <td align="center" valign="middle">Matric(s)</td>
                                    <td align="center" valign="middle">Reason</td>
                                    <td align="center" valign="middle">Goal</td>
                                    <td align="center" valign="middle">Commitment</td>
                                    <td align="center" valign="middle">Actual</td>
                                    <td align="right"><i class="glyphicon glyphicon-volume-up" aria-hidden="true"></i></td>
                                </tr>
                                <tr>
                                    <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></th>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="right"><i class="glyphicon glyphicon-play-circle" aria-hidden="true"></i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div role="tabpanel" class="tab-pane" id="Training">
                    <div class="table-responsive">
                        <table width="100%" class="table table-bordered table-striped">
                            <tbody>
                                <tr>
                                    <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-ok" aria-hidden="true"></i></th>
                                    <td align="center" valign="middle">Targeted Completion Date </td>
                                    <td align="center" valign="middle">Date Assigned</td>
                                    <td align="center" valign="middle">Actual Completion Date</td>
                                    <td align="center" valign="middle">Article Name</td>
                                    <td align="center" valign="middle">Associated Metric</td>
                                    <td align="right"><i class="glyphicon glyphicon-volume-up" aria-hidden="true"></i></td>
                                </tr>
                                <tr>
                                    <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></th>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>

                                    <td align="right"><i class="glyphicon glyphicon-play-circle" aria-hidden="true"></i></td>
                                </tr>
                                <tr>
                                    <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></th>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>

                                    <td align="right"><i class="glyphicon glyphicon-play-circle" aria-hidden="true"></i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div role="tabpanel" class="tab-pane" id="Task">
                    <div class="table-responsive">
                        <table width="100%" class="table table-bordered table-striped">
                            <tbody>
                                <tr>
                                    <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-ok" aria-hidden="true"></i></th>
                                    <td align="center" valign="middle">Date </td>
                                    <td align="center" valign="middle">Matric(s)</td>
                                    <td align="center" valign="middle">Reason</td>
                                    <td align="center" valign="middle">Goal</td>
                                    <td align="center" valign="middle">Commitment</td>
                                    <td align="center" valign="middle">Actual</td>
                                    <td align="right"><i class="glyphicon glyphicon-volume-up" aria-hidden="true"></i></td>
                                </tr>
                                <tr>
                                    <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></th>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="right"><i class="glyphicon glyphicon-play-circle" aria-hidden="true"></i></td>
                                </tr>
                                <tr>
                                    <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></th>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="right"><i class="glyphicon glyphicon-play-circle" aria-hidden="true"></i></td>
                                </tr>
                                <tr>
                                    <th align="center" valign="middle" scope="row"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></th>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="center" valign="middle"></td>
                                    <td align="right"><i class="glyphicon glyphicon-play-circle" aria-hidden="true"></i></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>


        </div>



        @* @Html.Partial("_PartialEmpPerfGrid", Model)*@


    </div>
      <input name="Type" id="kpimetricid" type="hidden" />

<div id="my-metric" class="modal fade" role="dialog">
    <div class="modal-dialog box-width">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" id="KPIName"><span></span> </h4>
            </div>
            <div class="modal-body" id="container">
                @*<img src="~/Content/assets/images/pie-chart2.png" alt="">*@
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>

    </div>
</div>

 <style>
        ul.text-color li a {
            color: #000 !important;
        }

            ul.text-color li a:hover {
                color: #000 !important;
            }

        ul.text-color li.active {
            color: #000 !important;
            background: #fff !important;
            border: solid 1px #ccc;
        }

            ul.text-color li.active a {
                color: #000 !important;
            }
    </style>
<script type="text/javascript">

    $(document).ready(function () {


       
        $("a.change_status").click(function () {
            $('#kpimetricid').val($(this).attr('href'));

            $('#KPIName span').text($(this).attr('href') + '  Comparison by Month to Goal');
            //  alert(status_id);
          bindGraph1();
           //return false;
        });
    });


    function bindGraph1() {

        var kpimetricvalue = $('#kpimetricid').val()
        var T = $('#typeID').val();

        $.ajax({
            type: "POST",
            url: '@Url.Action("ChimesComparisonChart", "Dashboard")',
                cache: false,
                dataType: "json",
                data: { 'type': T, 'kpimetericID': kpimetricvalue,'screentype':'Individual' },
                success: function (data) {

                    var data1 = new Array();
                    var data2 = new Array();
                    var data3 = new Array();
                    var data4 = new Array();
                    var processed_json = new Array();
                    //if (data.length == 0) {
                    //    $('#chartType').prop('disabled', true);

                    //}
                    //else {
                    //    $('#chartType').prop('disabled', false);
                    //}

                    for (i = 0; i < data.length; i++) {
                        processed_json.push(data[i].Actual);
                        data1[i] = data[i].Dispvalue;
                        data2[i] = data[i].Month;
                        data3[i] = data[i].Goal;
                        data4[i] = data[i].Actual;

                    }
                    //InsertLog($('#chartType').val());

                    createGraph({
                        chart: {
                            renderTo: 'container',
                            defaultSeriesType: 'column',
                            events: {
                                drilldown: function (e) {
                                    if (!e.seriesOptions) {
                                        var chart = this;
                                        //Show the loading label
                                        //chart.showLoading('Loading ...');
                                        setTimeout(function () {
                                            chart.hideLoading();
                                            chart.addSeriesAsDrilldown(e.point, series);
                                        }, 100);
                                    }
                                }
                            },
                            //plotBorderWidth: 1,                               
                            height: 200,
                        },
                        title: {
                            text: '',

                        },
                        //
                        subtitle: {
                            //   text: 'Subtitle'
                        },
                        //
                        xAxis: {
                            categories: data2,
                            title: {
                                text: 'Month'
                            }
                        },

                        yAxis: {
                            title: {

                            },
                            plotLines: [{
                                value: data3[0],
                                color: 'red',
                                width: 1,
                                label: {
                                    text: 'Goal :' + data3[0].toString(),
                                    align: 'center',
                                    style: {
                                        color: 'gray'
                                    }
                                }
                            }]
                        },


                        plotOptions: {
                            series: {
                                name: "",
                                cursor: 'pointer',
                                point: {
                                    events: {
                                        click: function () {
                                            var charttype = $('#chartType').val();

                                            var T = $('#typeID').val();
                                            $('#container3').hide();
                                            $('#container4').hide();
                                            $('#txtchart2 span').text(this.name.toString() + ' - Total Utilization');
                                            // alert(this.name);
                                            bindGraphdisposition1(this.name, $('#siteID').val(), $('#programID').val(), $('#agentID').val(), $('#yearID').val(), $('#monthID').val(), $('#weekID').val());
                                        }
                                    }
                                }
                            },

                            pie:
                            {
                                innerSize: 60,
                                depth: 25
                            },

                            column: {
                                stacking: 'normal',
                                dataLabels: {
                                    enabled: true,
                                    color: (Highcharts.theme && Highcharts.theme.dataLabelsColor) || 'white',
                                    style: {
                                        textShadow: '0 0 3px black'
                                    }
                                }
                            }
                        },


                        //
                        series: [{

                            showInLegend: false,
                            colorByPoint: true,
                            data: data4

                        }],
                        credits: {
                            enabled: false
                        },
                        navigation: {
                            buttonOptions: {
                                enabled: false
                            }
                        },
                        exportButton: {
                            enabled: false
                        },
                        //
                        drilldown: {
                            series: []
                        }

                    });

                    function createGraph(chartOptions) {
                        // open the basic chart
                        $(document).ready(function () {
                            // set the click event for the parent chart
                            if (data.length != 0) {
                                chartOptions.chart.events.click = function () {
                                    hs.htmlExpand(document.getElementById(chartOptions.chart.renderTo), {
                                        width: 4000,
                                        height: 2000,
                                        allowWidthReduction: true,
                                        preserveContent: false,

                                    }, {
                                        chartOptions: chartOptions
                                    });
                                };
                            }
                            var chart = new Highcharts.Chart(chartOptions);
                        });
                    }

                    // Create a new chart on Highslide popup open
                    hs.Expander.prototype.onAfterExpand = function () {
                        if (this.custom.chartOptions) {
                            var chartOptions = this.custom.chartOptions;
                            if (!this.hasChart) {
                                chartOptions.chart.renderTo = $('.highslide-body')[0];
                                chartOptions.chart.events.click = function () { };
                                var hsChart = new Highcharts.Chart(chartOptions);
                                hs.align = 'center';
                            }
                            this.hasChart = true;
                        }
                    };




                },
                error: function (result) {
                    alert('Cannot update selection values now!!');
                }
            })


        }
    

</script>

}